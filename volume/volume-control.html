<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Volume Control with Test Board</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(45deg, #7f7f7f,#73fbeb,#a2abfa, #f1a17b, #7b7b7b);
            overflow: hidden; /* Prevent scrollbars */
        }

        #volume-control {
            display: flex;
            flex-direction: column;
            align-items: center;    
            position: fixed;
            bottom: 10px; /* Move to the bottom */
            left: 1390px; /* Move to the left */
            transform: scale(0.30); /* Scale down to 30% */
            transform-origin: bottom left; /* Ensure scaling is relative to bottom left */
        }

        #sound-icon {
            width: 100px; /* You may adjust this if needed */
            cursor: pointer;
            transition: transform 0.5s ease;
            position: relative;
            left: -210px; /* Adjust this value to move it left or right */
            top: 0px; /* Adjust this value to move it up or down */
        }

        #volume-line {
            margin-top: 20px;
            background-color: #000000;
            border-radius: 5px;
            height: 10px;
            width: 400px; /* Adjusted width */
        }

        #ball {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgb(0, 0, 0);
            transform: translate(-50%, -50%);
            display: none; /* Initially hidden */
        }

        #board {
            width: 650px; /* Initial width */
            height: 500px; /* Initial height */
            border-radius: 20px; /* Rounded edges */
            background-color: #214919; /* Initial color */
            position: relative;
            transition: transform 0.1s; /* Smooth transform */
            transform-style: preserve-3d; /* Enable 3D transformations */
            border: 10px solid transparent; /* Initial border thickness */
            box-shadow: 0 0 0 10px transparent; /* Shadow for gradient effect */
        }

        /* Gradient border */
        #board::before {
            content: '';
            position: absolute;
            top: -10px; /* Same as border thickness */
            left: -10px; /* Same as border thickness */
            right: -10px; /* Same as border thickness */
            bottom: -10px; /* Same as border thickness */
            background: linear-gradient(-90deg, #aae9e9, #f7e0e0); /* Adjust this for your desired gradient */
            border-radius: 20px; /* Match the board's border radius */
            z-index: -1; /* Position it behind the board */
        }
    </style>
</head>

<body>
    <div id="volume-control">
        <img id="sound-icon" src="sound-icon.png" alt="Sound Icon" />
        <div id="volume-line"></div>
        <div id="ball" class="ball"></div> <!-- Ball element -->
    </div>

    <audio id="audio-player" src="soundtest.mp3" preload="auto"></audio>

    <div id="board"></div>

    <script>
        const soundIcon = document.getElementById('sound-icon');
        const ball = document.getElementById('ball');
        const audioPlayer = document.getElementById('audio-player');
        const board = document.getElementById('board');
        const originalTransform = 'translateZ(0)'; // Store original position
        let chargingTime = 0;
        let chargingInterval;

        soundIcon.addEventListener('mousedown', startCharging);
        soundIcon.addEventListener('mouseup', launchBall);

        function startCharging() {
            chargingTime = 0;
            soundIcon.style.transform = 'rotate(-50deg)'; // Tilt the icon upwards when pressed
            chargingInterval = setInterval(() => {
                chargingTime += 100; // Increase time while holding the icon
            }, 100);
        }

        function launchBall() {
            clearInterval(chargingInterval); // Stop charging when released
            const initialX = soundIcon.offsetLeft + soundIcon.offsetWidth / 2; // Icon center X
            const initialY = soundIcon.offsetTop; // Icon Y position
            ball.style.left = `${initialX}px`;
            ball.style.top = `${initialY}px`;
            ball.style.display = 'block'; // Show the ball

            const launchAngle = 45; // Set launch angle to 45 degrees
            moveBall(initialX, initialY, launchAngle); // Pass angle to moveBall

            // Reset the icon back to its original position after launching the ball
            setTimeout(() => {
                soundIcon.style.transform = 'rotate(0deg)'; // Reset the icon
            }, 300); // Adjust the delay as needed
        }

        function moveBall(initialX, initialY, angleInDegrees) {
            const gravity = 0.4; // Gravity value
            const angleInRadians = angleInDegrees * (Math.PI / 180); // Convert degrees to radians

            let initialSpeed = chargingTime / 30; // Adjust speed as needed
            if (initialSpeed < 1) initialSpeed = 1; // Ensure minimum speed

            let velocityX = initialSpeed * Math.cos(angleInRadians); // Horizontal velocity
            let velocityY = -initialSpeed * Math.sin(angleInRadians); // Vertical velocity

            let posX = initialX; // Start position on X
            let posY = initialY; // Start position on Y

            const volumeLineWidth = 400; // Change this to match the new volume line width

            const interval = setInterval(() => {
                posX += velocityX; // Update horizontal position
                posY += velocityY; // Update vertical position
                velocityY += gravity; // Apply gravity

                // Update ball position
                drawBall(posX, posY); // Call drawBall with current position

                // Check for collision with volume line
                if (posY >= (initialY + 120) && posX <= (initialX + volumeLineWidth)) { // Adjust to your volume line height
                    clearInterval(interval); // Stop animation
                    posY = initialY + 120; // Set ball position to volume line
                    drawBall(posX, posY); // Draw the ball at the new position
                    updateVolume(posX); // Update volume based on landing position
                    audioPlayer.currentTime = 0; // Reset audio to start
                    audioPlayer.play(); // Play audio
                }
            }, 30);
        }

        function drawBall(x, y) {
            ball.style.left = `${x}px`; // Update ball's left position
            ball.style.top = `${y}px`; // Update ball's top position
        }

        function updateVolume(landingPosition) {
            const volumeLineWidth = 400; // Update this to the same value as the CSS width
            const volumePercent = Math.min(Math.max((landingPosition - 20) / volumeLineWidth, 0), 1); // Ensure between 0 and 1
            audioPlayer.volume = volumePercent; // Set the audio player's volume
            console.log(`Volume: ${(volumePercent * 100).toFixed(0)}%`); // Log the volume percentage
        }

        // Mouse move event to create 3D effect on the board
        board.addEventListener('mousemove', (event) => {
            const { clientX, clientY } = event;
            const { offsetWidth, offsetHeight } = board;

            const boardRect = board.getBoundingClientRect();
            const centerX = boardRect.left + offsetWidth / 2;
            const centerY = boardRect.top + offsetHeight / 2;

            const xPos = (clientX - centerX) / (offsetWidth / 2);
            const yPos = (clientY - centerY) / (offsetHeight / 2);

            // Adjust the transform for 3D effect based on mouse position
            const rotateX = yPos * 25; // Adjust the sensitivity of vertical movement
            const rotateY = -xPos * 25; // Adjust the sensitivity of horizontal movement

            // Apply the rotation transformation
            board.style.transform = `translateZ(0) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });

        // Mouse leave event to reset the board position
        board.addEventListener('mouseleave', () => {
            board.style.transform = originalTransform; // Reset to original position
        });

        // Allow resizing the board
        board.addEventListener('dblclick', () => {
            const newWidth = prompt('Enter new width in pixels:', '400');
            const newHeight = prompt('Enter new height in pixels:', '300');
            if (newWidth && newHeight) {
                resizeBoard(parseInt(newWidth), parseInt(newHeight));
            }
        });

        // Allow changing color with a click
        /*board.addEventListener('click', () => {
            const newColor = prompt('Enter a new color (name or hex):', '#ffffff');
            if (newColor) {
                changeBoardColor(newColor);
            }
        });*/

        // Function to resize the board
        function resizeBoard(width, height) {
            board.style.width = `${width}px`;
            board.style.height = `${height}px`;
        }

        // Function to change board color
        function changeBoardColor(color) {
            board.style.backgroundColor = color;
        }
    </script>
</body>

</html>
